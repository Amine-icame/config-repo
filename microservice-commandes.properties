# Configuration de la base de données H2 (pour le microservice-commandes)
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

spring.datasource.url=jdbc:h2:mem:commandesdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=admin

# Configuration JPA et Hibernate
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true

# Configuration Eureka Client
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.instance.hostname=localhost
# S'assurer que le client Eureka est activé (par défaut, il l'est si la dépendance est présente)
eureka.client.enabled=true

# Port du microservice (ceci sera surchargé par le client si défini localement)
# Pour l'instant, on le laisse ici pour qu'il soit récupéré.
server.port=8081

# Propriété personnalisée de l'énoncé (partie c.)
mes-config-ms.commandes-last=20

# Configuration Resilience4j Circuit Breaker
# Nombre de requêtes à surveiller
resilience4j.circuitbreaker.instances.produitService.slidingWindowSize=10
# Pourcentage d'échecs pour ouvrir le circuit
resilience4j.circuitbreaker.instances.produitService.failureRateThreshold=50
 # Durée pendant laquelle le circuit reste ouvert
resilience4j.circuitbreaker.instances.produitService.waitDurationInOpenState=5s
 # Nombre d'appels en état HALF_OPEN
resilience4j.circuitbreaker.instances.produitService.permittedNumberOfCallsInHalfOpenState=3
 # Durée max d'attente pour la réponse
resilience4j.timelimiter.instances.produitService.timeoutDuration=2s

# Exposer les métriques Resilience4j via Actuator
management.endpoints.web.exposure.include=refresh,health,info,circuitbreakers
management.endpoint.circuitbreakers.enabled=true
